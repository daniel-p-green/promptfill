{
  "version": "2026-02-06.2",
  "extraction": [
    {
      "id": "email_basic",
      "raw_prompt": "Write an email to [recipient name] about {topic}.\nTone: {{tone}}\nContext: <context>",
      "expected_template": "Write an email to {{recipient_name}} about {{topic}}.\nTone: {{tone}}\nContext: {{context}}",
      "expected_variables": {
        "recipient_name": { "type": "string", "required": true },
        "topic": { "type": "string", "required": true },
        "tone": {
          "type": "enum",
          "required": true,
          "defaultValue": "concise",
          "options": ["concise", "friendly", "direct", "formal"]
        },
        "context": { "type": "text", "required": true }
      }
    },
    {
      "id": "boolean_inference",
      "raw_prompt": "Summarize {{notes}}. Include citations: [include_citations].",
      "expected_template": "Summarize {{notes}}. Include citations: {{include_citations}}.",
      "expected_variables": {
        "notes": { "type": "text", "required": true },
        "include_citations": { "type": "boolean", "required": true, "defaultValue": false }
      }
    },
    {
      "id": "enum_axes",
      "raw_prompt": "Summarize <source text> for {audience} in {format}. Length: {{length}}.",
      "expected_template": "Summarize {{source_text}} for {{audience}} in {{format}}. Length: {{length}}.",
      "expected_variables": {
        "source_text": { "type": "text", "required": true },
        "audience": {
          "type": "enum",
          "required": true,
          "defaultValue": "execs",
          "options": ["execs", "engineering", "sales", "customers"]
        },
        "format": {
          "type": "enum",
          "required": true,
          "defaultValue": "bullets",
          "options": ["bullets", "paragraphs", "email", "slack_update"]
        },
        "length": {
          "type": "enum",
          "required": true,
          "defaultValue": "short",
          "options": ["short", "medium", "long"]
        }
      }
    },
    {
      "id": "repeated_placeholder_name_dedup",
      "raw_prompt": "Draft this for [Recipient Name]. Mention [Recipient Name] and [Recipient Name] again.",
      "expected_template": "Draft this for {{recipient_name}}. Mention {{recipient_name}} and {{recipient_name}} again.",
      "expected_variables": {
        "recipient_name": { "type": "string", "required": true, "defaultValue": "" }
      }
    },
    {
      "id": "mixed_styles_and_normalization",
      "raw_prompt": "Translate for {Target Language}. Include [Audience-Type] notes from <source text>.",
      "expected_template": "Translate for {{target_language}}. Include {{audience_type}} notes from {{source_text}}.",
      "expected_variables": {
        "target_language": {
          "type": "enum",
          "required": true,
          "defaultValue": "english",
          "options": ["english", "spanish", "french", "german"]
        },
        "audience_type": {
          "type": "enum",
          "required": true,
          "defaultValue": "execs",
          "options": ["execs", "engineering", "sales", "customers"]
        },
        "source_text": { "type": "text", "required": true, "defaultValue": "" }
      }
    },
    {
      "id": "no_placeholders_no_variables",
      "raw_prompt": "Write a concise summary of this release plan.",
      "expected_template": "Write a concise summary of this release plan.",
      "expected_variables": {}
    }
  ],
  "render": [
    {
      "id": "render_missing_required",
      "template": "Write to {{recipient_name}} about {{topic}} in a {{tone}} tone.",
      "variables": [
        { "name": "recipient_name", "type": "string", "required": true, "defaultValue": "" },
        { "name": "topic", "type": "string", "required": true, "defaultValue": "" },
        {
          "name": "tone",
          "type": "enum",
          "required": true,
          "defaultValue": "concise",
          "options": ["concise", "friendly"]
        }
      ],
      "values": { "recipient_name": "Alex" },
      "expected": { "missingRequired": ["topic"], "rendered": "Write to Alex about {{topic}} in a concise tone." }
    },
    {
      "id": "render_with_defaults",
      "template": "Tone: {{tone}}",
      "variables": [
        { "name": "tone", "type": "enum", "required": true, "defaultValue": "friendly", "options": ["friendly"] }
      ],
      "values": {},
      "expected": { "missingRequired": [], "rendered": "Tone: friendly" }
    },
    {
      "id": "render_boolean_default_false",
      "template": "Include citations: {{include_citations}}",
      "variables": [{ "name": "include_citations", "type": "boolean", "required": true, "defaultValue": false }],
      "values": {},
      "expected": { "missingRequired": [], "rendered": "Include citations: false" }
    },
    {
      "id": "render_prefers_explicit_value",
      "template": "Tone: {{tone}}",
      "variables": [
        { "name": "tone", "type": "enum", "required": true, "defaultValue": "concise", "options": ["concise", "friendly"] }
      ],
      "values": { "tone": "friendly" },
      "expected": { "missingRequired": [], "rendered": "Tone: friendly" }
    },
    {
      "id": "render_keeps_unknown_placeholder",
      "template": "Send to {{recipient_name}} about {{unknown_field}}.",
      "variables": [{ "name": "recipient_name", "type": "string", "required": true, "defaultValue": "" }],
      "values": { "recipient_name": "Mina" },
      "expected": { "missingRequired": [], "rendered": "Send to Mina about {{unknown_field}}." }
    },
    {
      "id": "render_missing_required_without_default",
      "template": "Audience: {{audience}}",
      "variables": [{ "name": "audience", "type": "string", "required": true, "defaultValue": "" }],
      "values": {},
      "expected": { "missingRequired": ["audience"], "rendered": "Audience: {{audience}}" }
    }
  ],
  "store": [
    {
      "id": "save_and_list",
      "templatesToSave": [
        {
          "id": "t_1",
          "name": "Email outreach",
          "template": "Write to {{recipient_name}} about {{topic}}.",
          "variables": [],
          "createdAt": "2026-02-06T00:00:00.000Z"
        }
      ],
      "expectedListCount": 1,
      "expectedTemplateIdsInOrder": ["t_1"],
      "expectedTemplateNamesInOrder": ["Email outreach"]
    },
    {
      "id": "save_two_templates_in_order",
      "templatesToSave": [
        {
          "id": "t_1",
          "name": "Email outreach",
          "template": "Write to {{recipient_name}} about {{topic}}.",
          "variables": [],
          "createdAt": "2026-02-06T00:00:00.000Z"
        },
        {
          "id": "t_2",
          "name": "Meeting summary",
          "template": "Summarize {{notes}} for {{audience}}.",
          "variables": [],
          "createdAt": "2026-02-06T00:01:00.000Z"
        }
      ],
      "expectedListCount": 2,
      "expectedTemplateIdsInOrder": ["t_1", "t_2"],
      "expectedTemplateNamesInOrder": ["Email outreach", "Meeting summary"]
    },
    {
      "id": "overwrite_template_same_id",
      "templatesToSave": [
        {
          "id": "t_1",
          "name": "Old name",
          "template": "Old template {{field}}.",
          "variables": [],
          "createdAt": "2026-02-06T00:00:00.000Z"
        },
        {
          "id": "t_1",
          "name": "New name",
          "template": "New template {{field}}.",
          "variables": [],
          "createdAt": "2026-02-06T00:02:00.000Z"
        }
      ],
      "expectedListCount": 1,
      "expectedTemplateIdsInOrder": ["t_1"],
      "expectedTemplateNamesInOrder": ["New name"]
    }
  ]
}
